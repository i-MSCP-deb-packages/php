From cee97220285fd7b955a58617b3e0300ec104ed87 Mon Sep 17 00:00:00 2001
From: Dmitry Stogov <dmitry@zend.com>
Date: Tue, 14 Apr 2015 15:47:26 +0300
Subject: [PATCH] Fixed recently introduced memory leak

---
 ext/phar/phar.c |    1 +
 1 file changed, 1 insertion(+)

--- a/ext/phar/phar.c
+++ b/ext/phar/phar.c
@@ -1113,6 +1113,7 @@ static int phar_parse_pharfile(php_strea
 			entry.metadata_len = 0;
 		}
 		if (len > endbuffer - buffer) {
+			pefree(entry.filename, entry.is_persistent);
 			MAPPHAR_FAIL("internal corruption of phar \"%s\" (truncated manifest entry)");
 		}
 		if (phar_parse_metadata(&buffer, &entry.metadata, len TSRMLS_CC) == FAILURE) {
